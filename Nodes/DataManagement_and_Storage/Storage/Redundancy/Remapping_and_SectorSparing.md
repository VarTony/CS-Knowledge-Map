---
title: Ремаппинг и резервирование секторов на магнитных дисках
---

# Ремаппинг и резервирование секторов на магнитных дисках


При длительной эксплуатации диска отдельные сектора на поверхности пластины могут начинать деградировать —  
из-за микроскопических повреждений магнитного слоя, загрязнений или нестабильности сигнала.

Чтобы предотвратить потерю данных, контроллер накопителя применяет приём **ремаппинга (remapping)**  
или **резервирования секторов (sector sparing)** — перенос информации с повреждённого участка пластины  
в исправный резервный сектор, расположенный на той же поверхности.

---

## Суть идеи

Контроллер диска постоянно отслеживает качество чтения секторов.  
Когда один из них начинает давать ошибки или повышенные задержки, он помечается как *«подозрительный»*,  
а его содержимое (если ещё читается) копируется в резервный сектор.

Затем в служебной таблице диска (**P-list** или **G-list**) создаётся запись,  
что обращение к старому логическому адресу теперь должно перенаправляться к новому сектору.

Для операционной системы и файловой системы этот процесс **полностью прозрачен** —  
она продолжает видеть тот же диапазон логических блоков (**LBA**), не подозревая,  
что физическое расположение данных изменилось.

---

## Как это устроено

Ремаппинг реализуется на уровне микропрограммы (**firmware**) контроллера диска.  
В накопителе изначально предусмотрена **резервная область** — часть секторов, не видимая пользователю.  
Именно туда записываются данные с повреждённых участков.

При каждом старте диска контроллер загружает две таблицы:

- **P-list (Permanent defect list)** — дефекты, выявленные ещё на заводе;  
- **G-list (Grown defect list)** — дефекты, появившиеся в процессе эксплуатации.

Когда новый сектор признаётся неисправным, он добавляется в **G-list**,  
а все обращения к нему перенаправляются на резервный сектор.

---

## Почему это работает эффективно

- **Абстрагирование для ОС и СУБД.**  
  Переназначение происходит на аппаратном уровне, без участия драйверов или файловой системы.

- **Минимизация потерь.**  
  Даже частично читаемые данные успевают быть скопированы в резервный сектор,  
  предотвращая логическое повреждение файлов.

- **Автоматическое обслуживание.**  
  Контроллер сам ведёт статистику ошибок и выполняет ремаппинг,  
  не требуя вмешательства пользователя.

- **Продление срока службы.**  
  За счёт постепенного вывода из обращения дефектных областей диск может корректно работать годами,  
  несмотря на микроповреждения поверхности.

---

## Аппаратный и программный уровни

Ремаппинг относится исключительно к **аппаратным механизмам хранения**.  
СУБД, драйверы и ОС не участвуют в процессе — они лишь получают стабильный логический адресный слой.

---

### Для сравнения

| Механизм | Уровень | Назначение |
|-----------|----------|-------------|
| **RAID-зеркалирование (RAID-1)** | Междисковый | Дублирует данные на разных физических дисках |
| **Ремаппинг** | Внутридисковый | Перемещает данные между секторами одной и той же пластины |
| **Readahead / Buffering** | Программный | Методы ускорения ввода-вывода, не связанные с исправлением ошибок |

---

## Почему ремаппинг ограничен

Каждый диск имеет **конечное число резервных секторов**.  
Когда они исчерпываются, новые дефекты уже не могут быть замещены —  
начинаются неисправимые ошибки чтения (**UNC errors**),  
сигнализирующие о приближении конца ресурса накопителя.

---

## Итог

**Ремаппинг секторов (sector remapping)** — это механизм *самовосстановления диска* на аппаратном уровне.  
Он автоматически заменяет сбойные сектора резервными, поддерживая логическую целостность данных  
без участия операционной системы или СУБД.

Благодаря этому пользователю видится надёжный непрерывный адресный диапазон,  
а диск способен долго сохранять работоспособность,  
даже при постепенной деградации поверхности.

---

### Связанные темы

- [Геометрия пластин и цилиндров](/Nodes/DataManagement_and_Storage/Storage/Physical_layer/DiskGeometry.md)
- [Отказоустойчивость и MTTDL](/Nodes/DataManagement_and_Storage/Storage/FaultTolerance/MTBF_and_MTTDL.md)
- [RAID-зеркалирование](./Mirroring.md)
