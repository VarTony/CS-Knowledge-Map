## Геометрия пластин и организация данных на магнитных дисках

Магнитный жёсткий диск (HDD) представляет собой набор вращающихся **пластин (platters)**, покрытых ферромагнитным слоем.
Каждая пластина разделена на **дорожки (tracks)** — концентрические окружности, а дорожки — на **секторы**, являющиеся минимальной единицей чтения/записи (обычно 512 байт или 4096 байт).

Для повышения плотности хранения и скорости доступа данные организованы по принципу **цилиндров**, **поверхностей** и **зон**.
Понимание геометрии пластин — ключ к пониманию физической производительности дисков и алгоритмов их оптимизации.

---

### Структура диска

* **Пластины (Platters)** — физические носители, вращающиеся с постоянной скоростью (например, 7200 об/мин).
* **Головки (Heads)** — считывающие/записывающие устройства, по одной на каждую сторону пластины.
* **Дорожки (Tracks)** — концентрические круги на поверхности, по которым перемещается головка.
* **Секторы (Sectors)** — фиксированные фрагменты дорожки, содержащие один блок данных.
* **Цилиндр (Cylinder)** — совокупность дорожек на всех пластинах, расположенных на одной и той же радиальной позиции.

> Когда головка перемещается по радиусу, она фактически «переходит» от одного цилиндра к другому.
> Поэтому операции чтения из последовательных блоков в пределах одного цилиндра выполняются **без перемещения головок** — что в десятки раз быстрее, чем при случайных обращениях.

---

### Геометрия и производительность

1. **Последовательное чтение и запись**
   Когда данные расположены подряд в пределах одного цилиндра, чтение происходит потоком — только вращением пластин.
   Механическое перемещение головок (seek) отсутствует, и скорость достигает максимума.

2. **Случайное чтение (random access)**
   Требует перемещения головки на другую дорожку → это означает:

   * время позиционирования (seek time, 2–10 мс);
   * ожидание вращения (rotational latency);
   * снижение пропускной способности в десятки раз.

3. **Зонная запись (Zoned Bit Recording)**
   Наружные дорожки длиннее, поэтому содержат больше секторов.
   Контроллер диска делит поверхность на **зоны** (zone groups), каждая со своим числом секторов на дорожку.
   Благодаря этому увеличивается общая ёмкость, но скорость чтения на внешних зонах выше, чем на внутренних.

---

### Организация данных по цилиндрам

Современные системы стараются **располагать логически последовательные блоки данных** в пределах одного цилиндра или соседних цилиндров, чтобы минимизировать seek.
Это особенно важно для СУБД и файловых систем, где большие последовательные чтения (scans, merges, joins) критичны для производительности.

* **Sequential cylinder allocation** — распределение блоков таблицы или индекса по последовательным цилиндрам.
* **Track skewing** — сдвиг начала данных на следующей дорожке, чтобы головка успела перейти при вращении.
* **Interleaving** — пропуск промежуточных секторов при записи, чтобы контроллер успевал обработать данные (актуально для старых дисков).

---

### Алгоритмы доступа и геометрия

Схема расположения блоков влияет на работу планировщиков ввода-вывода.
Например, **алгоритм лифта (Elevator / SCAN)** оптимизирует порядок чтения блоков, проходя по дорожкам в одну сторону, затем — в обратную.
Таким образом, обращения к секторам упорядочиваются по цилиндрам, уменьшая количество перемещений головок и повышая общую скорость обработки.

---

### Физическая абстракция

Современные диски скрывают реальную геометрию от операционной системы —
она работает с **логическими адресами блоков (LBA)**, а не с физическими CHS (Cylinder-Head-Sector).
Контроллер диска сам решает, где физически расположить данные, чтобы достичь баланса между:

* производительностью (минимум seek’ов),
* надёжностью (распределение нагрузки между головками),
* износом (равномерное использование поверхности).

---

### Итог

Геометрия пластин — это физическая основа работы магнитных дисков.
Цилиндры, дорожки и секторы определяют то, как данные реально хранятся и считываются, а знание этой структуры необходимо для понимания:

* почему последовательный доступ быстрее случайного;
* как работают планировщики дискового ввода-вывода (elevator, SCAN, C-SCAN);
* зачем СУБД стремится хранить таблицы и индексы «близко» по цилиндрам;
* почему внешние зоны читаются быстрее внутренних;
* и как на физическом уровне строится избыточность и ремаппинг секторов.

Глубокое понимание геометрии пластин позволяет проектировать эффективные и надёжные системы хранения — от архитектуры RAID до низкоуровневых оптимизаций ввода-вывода в СУБД.

