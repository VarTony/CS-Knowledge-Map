# Основные уровни RAID (0–6)

RAID — это способ объединить несколько физических дисков в единый логический массив.  
Каждый уровень задаёт баланс между скоростью, надёжностью и эффективностью использования места.  
Основная идея — делить данные на блоки (stripes) и при необходимости добавлять избыточность в виде паритета или зеркал.

---

## RAID 0 — Полосы без избыточности (Кэш)

**Суть:** данные просто разбиваются на блоки и записываются по очереди на все диски.  

- Диск 1 Диск 2  
  A₁   A₂  
  B₁   B₂  

**Преимущества:**  
- Максимальная скорость (чтение и запись параллельно).  
- Полная ёмкость (всё пространство используется).  

**Недостаток:**  
- При потере одного диска теряются все данные.  

---

## RAID 1 — Зеркало (Системные диски)

**Суть:** каждый блок записывается на два диска одновременно.  

- Диск 1 Диск 2  
  A   A  
  B   B  

**Преимущества:**  
- Полная защита при отказе 1 диска.  
- Простое восстановление — просто копия.  

**Недостатки:**  
- Половина объёма теряется (2 диска = 1 полезный).  
- Медленнее запись (в два места).  

---

## RAID 2 — Побитовая избыточность (исторический, не используется)

**Суть:** каждый бит данных записывается на свой диск, а отдельные диски хранят коды Хэмминга для исправления ошибок.  

- D1 D2 D3 D4 D5 D6 D7  
  b₁ b₂ b₃ b₄ p₁ p₂ p₃  

**Преимущества:**  
- Может исправлять ошибки на лету.  

**Недостатки:**  
- Требует много дисков.  
- Практически не используется (современные диски уже делают ECC внутри).  

---

## RAID 3 — Побайтовый паритет (Видео/аудиопотоки)

**Суть:** данные делятся на байты, один отдельный диск хранит XOR-паритет.  

- D1   D2   D3   Parity  
  10110010 11001100 10011100 01100010  

**Преимущества:**  
- Высокая скорость последовательного чтения.  
- Защита от отказа 1 диска.  

**Недостатки:**  
- Паритет-диск нагружается сильнее остальных.  
- Неэффективен при множественных мелких записях.  

---

## RAID 4 — Поблочный паритет (Архивы, базы данных)

**Суть:** данные хранятся блоками (страйпами), а один диск хранит XOR-паритет всех блоков.  

- D1 D2 D3 Parity  
  A₁ A₂ A₃ P₁  
  B₁ B₂ B₃ P₂  

**Преимущества:**  
- Можно читать параллельно.  
- Простое восстановление.  

**Недостатки:**  
- Паритет-диск — узкое место (все записи проходят через него).  

---

## RAID 5 — Распределённый паритет (Серверы, NAS)

**Суть:** паритеты (XOR) распределяются по всем дискам, чтобы не было узкого места.  

- D1 D2 D3 D4  
  A₁ A₂ A₃ P₁  
  B₁ P₂ B₂ B₃  
  P₃ C₁ C₂ C₃  

**Преимущества:**  
- Выдерживает отказ 1 диска.  
- Высокая скорость чтения, равномерная нагрузка.  
- Эффективность: (N–1) дисков полезных.  

**Недостаток:**  
- Потеря 2 дисков = потеря данных.  

**Пример:**  
A = 10110010  
B = 11001100  
C = 01111110 (A⊕B)  
Если пропал A → A = B⊕C.  
Простая битовая маска взаимосвязей.  

---

## RAID 6 — Двойной паритет (Крупные хранилища)

**Суть:** то же, что RAID 5, но добавлен второй независимый паритет Q.  

- D1 D2 D3 D4 D5  
  A₁ A₂ A₃ P₁ Q₁  
  B₁ P₂ Q₂ B₂ B₃  

**Преимущества:**  
- Выдерживает отказ 2 дисков.  
- Идеален для больших систем (NAS, серверы).  

**Недостатки:**  
- Медленнее запись (два паритета).  
- Меньше полезного пространства: (N–2) дисков.  

**Пример:**  
A = 10110010  
B = 11001100  
P = A⊕B = 01111110  
Q = A⊕(B<<1) = 00101010  
Если сломались два диска — система решает XOR-уравнения и восстанавливает оба блока.  

---

## Итог

Уровни RAID — это градации между скоростью и надёжностью.  
RAID 0 — производительность,  
RAID 5 и 6 — сбалансированные решения, использующие побитовые маски (XOR-паритеты)  
для восстановления данных без полного дублирования, но снижена производительность.  

---

### Связанные темы

- [Геометрия пластин и цилиндров](../PhysicalLayer/DiskGeometry.md)  
- [Ремаппинг и резервирование секторов](./Remapping_and_SectorSparing.md)  
- [Отказоустойчивость и MTTDL](../FaultTolerance/MTBF_and_MTTDL.md)  
- [Алгоритм лифта (SCAN)](../IO_Scheduling/Elevator_vs_SCAN.md)
